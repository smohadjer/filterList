{"version":3,"sources":["filterList.js"],"names":["FilterList","options","urlIsUpdatable","undefined","element","filters","filterNames","getAttribute","split","initCallback","filtersCallback","url","window","location","href","lastClass","hiddenClass","setEventHandlers","setDefaultFilters","updateFiltersfromURL","updateBrowserHistory","applyFilters","history","pushState","state","slice","replaceState","document","title","forEach","filterName","i","ignoreValue","getFilterIgnoreValue","filterValue","getFilterValue","console","log","push","name","value","filterElement","querySelector","tagName","warn","checked","newValue","getUrlParameter","updateFilters","updatedFilter","triggerEvent","filter","find","updateDOM","addEventListener","e","updateURL","prop","filtersArray","property","item","matchedItems","listItems","children","lastVisibleElement","classList","remove","matched","hasAttribute","el","add","length","Object","assign","updateQueryStringParameter","removeURLParameter","sParam","sPageURL","decodeURIComponent","search","substring","sURLVariables","sParameterName","uri","key","re","RegExp","separator","indexOf","match","replace","parameter","urlparts","prefix","encodeURIComponent","pars","lastIndexOf","splice","join"],"mappings":"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","file":"filterList.js","sourcesContent":["/*\n * @name          filterList.js\n * @version       3.1.0\n * @lastmodified  2018-02-06\n * @author        Saeid Mohadjer\n * @repo\t\t  https://github.com/smohadjer/filterList\n *\n * Licensed under the MIT License\n */\n\n'use strict';\n\nclass FilterList {\n\tconstructor(options) {\n\t\tthis.urlIsUpdatable = (options.urlIsUpdatable === undefined) ? false : options.urlIsUpdatable;\n\t\tthis.element = options.element;\n\t\tthis.filters = [];\n\t\tthis.filterNames = this.element.getAttribute('data-filter-names').split(' ');\n\t\tthis.initCallback = options.initCallback;\n\t\tthis.filtersCallback = options.filtersCallback;\n\t\tthis.url = window.location.href;\n\t\tthis.lastClass = options.lastClass || 'last';\n\t\tthis.hiddenClass = options.hiddenClass || 'hidden';\n\n\t\tthis.setEventHandlers();\n\t\tthis.setDefaultFilters(this.filterNames);\n\t\tthis.updateFiltersfromURL();\n\t\tthis.updateBrowserHistory();\n\n\t\tif (typeof this.initCallback === 'function') {\n\t\t\tthis.initCallback();\n\t\t}\n\n\t\tthis.applyFilters();\n\t}\n\n\tupdateBrowserHistory() {\n\t\tif (this.urlIsUpdatable && window.history && window.history.pushState) {\n\t\t\tlet state = {};\n\t\t\tstate.filters = this.filters.slice();\n\t\t\thistory.replaceState(state, document.title, this.url);\n\t\t}\n\t}\n\n\tsetDefaultFilters(filterNames) {\n\t\tfilterNames.forEach((filterName, i) => {\n\t\t\t//const ignoreValue = this.element.getAttribute(`data-filter-${filterName}-ignore`);\n\t\t\tconst ignoreValue = this.getFilterIgnoreValue(filterName);\n\t\t\tconst filterValue = this.getFilterValue(filterName);\n\n\t\t\tconsole.log('default filters: ', filterName, filterValue, ignoreValue);\n\n\t\t\tthis.filters.push({\n\t\t\t\tname: filterName,\n\t\t\t\tvalue: filterValue,\n\t\t\t\tignoreValue: ignoreValue\n\t\t\t});\n\t\t});\n\t}\n\n\tgetFilterIgnoreValue(filterName) {\n\t\tconst filterElement = document.querySelector(`[name=\"${filterName}\"]`);\n\t\tlet ignoreValue;\n\n\t\tif (filterElement) {\n\t\t\tif (filterElement.tagName === 'SELECT') {\n\t\t\t\tignoreValue = filterElement.getAttribute('data-ignore');\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('No filter with name ' + filterName + ' was found in markup!');\n\t\t}\n\n\t\treturn ignoreValue;\n\t}\n\n\tgetFilterValue(filterName) {\n\t\tconst filterElement = document.querySelector(`[name=\"${filterName}\"]`);\n\t\tlet filterValue;\n\n\t\tif (filterElement) {\n\t\t\tif (filterElement.getAttribute('type') === 'checkbox') {\n\t\t\t\tfilterValue = filterElement.checked ? filterElement.value : undefined;\n\t\t\t} else {\n\t\t\t\tfilterValue = filterElement.value;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('No filter with name ' + filterName + ' was found in markup!');\n\t\t}\n\n\t\treturn filterValue;\n\t}\n\n\tupdateFiltersfromURL() {\n\t\tthis.filterNames.forEach((filterName, i) => {\n\t\t\tconst newValue = this.getUrlParameter(filterName);\n\n\t\t\tif (newValue) {\n\t\t\t\tthis.updateFilters({\n\t\t\t\t\tname: filterName,\n\t\t\t\t\tvalue: newValue\n\t\t\t\t}, true);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateFilters(updatedFilter, triggerEvent) {\n\t\tlet filter = this.filters.find((filter) => filter.name === updatedFilter.name);\n\n\t\tif (filter && filter.value !== updatedFilter.value) {\n\t\t\tfilter.value = updatedFilter.value;\n\t\t\tthis.applyFilters();\n\n\t\t\tif (triggerEvent) {\n\t\t\t\tthis.updateDOM([filter]);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetEventHandlers() {\n\t\tthis.filterNames.forEach((filterName, i) => {\n\t\t\tconst filterElement = document.querySelector('[name=\"' + filterName + '\"]');\n\n\t\t\tif (filterElement) {\n\t\t\t\tfilterElement.addEventListener('change', (e) => {\n\t\t\t\t\tconsole.log(filterName, this.getFilterValue(filterName));\n\t\t\t\t\tthis.updateFilters({\n\t\t\t\t\t\tname: filterName,\n\t\t\t\t\t\tvalue: this.getFilterValue(filterName)\n\t\t\t\t\t});\n\n\t\t\t\t\tif (this.urlIsUpdatable) {\n\t\t\t\t\t\tthis.updateURL();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif (this.urlIsUpdatable && window.history && window.history.pushState) {\n\t\t\twindow.addEventListener(\"popstate\", (e) => {\n\t\t\t\tif (e.state.filters) {\n\t\t\t\t\tfor (let prop in e.state.filters) {\n\t\t\t\t\t\tthis.filters[prop] = e.state.filters[prop];\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.updateDOM(e.state.filters);\n\t\t\t\t\tthis.applyFilters();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateDOM(filtersArray) {\n\t\tfor (let i in filtersArray) {\n\t\t\tlet filter = filtersArray[i];\n\t\t\tlet filterElement = document.querySelector(`[name=\"${filter.name}\"]`);\n\n\t\t\tif (filterElement) {\n\t\t\t\tif (filterElement.tagName === 'SELECT') {\n\t\t\t\t\tfilterElement.value = filter.value;\n\t\t\t\t}\n\n\t\t\t\tif (filterElement.tagName === 'INPUT') {\n\t\t\t\t\tif (filterElement.getAttribute('type') === 'checkbox') {\n\t\t\t\t\t\tfilterElement.checked = (filterElement.value === filter.value) ? true : false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//public method for changing filters\n\tsetFilters(filters) {\n\t\tfor (let property in filters) {\n\t\t\tthis.filters.forEach(function(item, i) {\n\t\t\t\tif (item.name === property) {\n\t\t\t\t\titem.value = filters[property];\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tthis.updateDOM(this.filters);\n\t\tthis.applyFilters();\n\n\t\tif (this.urlIsUpdatable) {\n\t\t\tthis.updateURL();\n\t\t}\n\t}\n\n\tapplyFilters() {\n\t\tlet matchedItems = [];\n\t\tconst listItems = this.element.children;\n\n\t\tif (this.lastClass) {\n\t\t\tlet lastVisibleElement = this.element.querySelector(`.${this.lastClass}`);\n\t\t\tif (lastVisibleElement) {\n\t\t\t\tlastVisibleElement.classList.remove(this.lastClass);\n\t\t\t}\n\t\t}\n\n\t\t// If filters are set, only items whose data attributes\n\t\t//match all the set filters would show\n\t\t[...listItems].forEach((element) => {\n\t\t\tlet matched = true;\n\n\t\t\tthis.filters.forEach(function(filter, i) {\n\t\t\t\tif (filter.value !== undefined && filter.value !== filter.ignoreValue) {\n\t\t\t\t\t//any list item that doesn't have attribute for this filter or\n\t\t\t\t\t//has attribute for this filter with another value should\n\t\t\t\t\t//be filtered out.\n\t\t\t\t\tif (!element.hasAttribute('data-filter-' + filter.name) || element.getAttribute('data-filter-' + filter.name) !== filter.value) {\n\t\t\t\t\t\tmatched = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (matched) {\n\t\t\t\tmatchedItems.push(element);\n\t\t\t}\n\t\t});\n\n\t\t[...listItems].forEach((el) => {\n\t\t\tel.classList.add(this.hiddenClass);\n\t\t});\n\n\t\tif (matchedItems.length !== 0) {\n\t\t\tmatchedItems.forEach((item, i) => {\n\t\t\t\titem.classList.remove(this.hiddenClass);\n\n\t\t\t\t//add a class to last visible item in the list in case last item in list needs special styling\n\t\t\t\tif (this.lastClass && i === matchedItems.length - 1) {\n\t\t\t\t\titem.classList.add(this.lastClass);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.element.classList.remove('is-empty');\n\t\t} else {\n\t\t\tthis.element.classList.add('is-empty');\n\t\t}\n\n\t\tif (typeof this.filtersCallback === 'function') {\n\t\t\tthis.filtersCallback();\n\t\t}\n\t}\n\n\tupdateURL() {\n\t\tif (window.history && window.history.pushState)\t{\n\t\t\tlet state = {};\n\t\t\tstate.filters = Object.assign({}, this.filters);\n\n\t\t\tthis.filters.forEach((filter) => {\n\t\t\t\tif (filter.value !== undefined && filter.value.length !== 0 && filter.value !== filter.ignoreValue) {\n\t\t\t\t\tthis.url = this.updateQueryStringParameter(this.url, filter.name, filter.value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.url = this.removeURLParameter(this.url, filter.name);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thistory.pushState(state, document.title, this.url);\n\t\t}\n\t}\n\n\t//http://stackoverflow.com/questions/19491336/get-url-parameter-jquery-or-how-to-get-query-string-values-in-js\n\tgetUrlParameter(sParam) {\n\t\tvar sPageURL = decodeURIComponent(window.location.search.substring(1)),\n\t\t\tsURLVariables = sPageURL.split('&'),\n\t\t\tsParameterName,\n\t\t\ti;\n\n\t\tfor (i = 0; i < sURLVariables.length; i++) {\n\t\t\tsParameterName = sURLVariables[i].split('=');\n\n\t\t\tif (sParameterName[0] === sParam) {\n\t\t\t\treturn sParameterName[1] === undefined ? true : sParameterName[1];\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateQueryStringParameter(uri, key, value) {\n\t\tvar re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n\t\tvar separator = uri.indexOf('?') !== -1 ? \"&\" : \"?\";\n\n\t\tif (uri.match(re)) {\n\t\t\treturn uri.replace(re, '$1' + key + \"=\" + value + '$2');\n\t\t} else {\n\t\t\treturn uri + separator + key + \"=\" + value;\n\t\t}\n\t}\n\n\tremoveURLParameter(url, parameter) {\n\t    //prefer to use l.search if you have a location/link object\n\t    var urlparts= url.split('?');\n\t    if (urlparts.length >= 2) {\n\t        var prefix= encodeURIComponent(parameter)+'=';\n\t        var pars= urlparts[1].split(/[&;]/g);\n\n\t        //reverse iteration as may be destructive\n\t        for (var i= pars.length; i-- > 0;) {\n\t            //idiom for string.startsWith\n\t            if (pars[i].lastIndexOf(prefix, 0) !== -1) {\n\t                pars.splice(i, 1);\n\t            }\n\t        }\n\n\t        url= urlparts[0] + (pars.length > 0 ? '?' + pars.join('&') : \"\");\n\t        return url;\n\t    } else {\n\t        return url;\n\t    }\n\t}\n}\n"]}